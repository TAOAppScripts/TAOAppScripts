function captureImage(fileName, document, clipRect,folder) {         var fileOutput = new File(folder +"/"+ fileName);    var imageCaptureOptions = new ImageCaptureOptions();    imageCaptureOptions.resolution = selected_rbutton(radio_group);    imageCaptureOptions.transparency = true;    document.imageCapture(fileOutput, clipRect, imageCaptureOptions);}// Message areavar box = new Window('dialog', "TAO Export Options");  w = box.add('panel', undefined, "Resolució Exportació (ppp)"); var radio_group = w.add ("panel"); radio_group.alignChildren = "left"; radio_group.add ("radiobutton", undefined, "50"); radio_group.add ("radiobutton", undefined, "75"); radio_group.add ("radiobutton", undefined, "100"); radio_group.add ("radiobutton", undefined, "150"); radio_group.add ("radiobutton", undefined, "200"); radio_group.add ("radiobutton", undefined, "300"); radio_group.add ("radiobutton", undefined, "400"); radio_group.children[5].value = true;function selected_rbutton (rbuttons) { for (var i = 0; i < rbuttons.children.length; i++) if (rbuttons.children[i].value == true) return rbuttons.children[i].text; }z = box.add('panel', undefined, "Tipus exportació"); var radio_group2 = z.add ("panel"); radio_group2.alignChildren = "left"; radio_group2.add ("radiobutton", undefined, "images"); radio_group2.add ("radiobutton", undefined, "measures"); radio_group2.children[1].value = true;box.panel2 = box.add('panel', undefined, "");  box.panel2.group = box.panel2.add('group', undefined );  box.panel2.group.orientation='row';  box.panel2.group.closeBtn = box.panel2.group.add('button',undefined, "Continuar", {name:'close'});  box.panel2.group.closeBtn.onClick = function(){  box.close();}   box.show() var folder= Folder.selectDialog ("Selecciona un directori");$.writeln("FOLDER:"+folder);var docSource = app.activeDocument;var layer = docSource.layers["drawings"]var layer_meas=docSource.layers["measures"]// Rasterize only first 3 items for debug purposes. Remove for release usage.var groupItemsLength = layer.groupItems.length;//groupItemsLength=3for (var i = 0; i < groupItemsLength; i++) {//for (var i = 0; i < 4; i++) {    var groupItem = layer.groupItems[i];           var docTemp = app.documents.add(DocumentColorSpace.CMYK, app.activeDocument.width, app.activeDocument.height);    var layerTemp = docTemp.layers[0];    var groupItemTemp = groupItem.duplicate(layerTemp, ElementPlacement.PLACEATEND);    $.writeln(groupItemTemp.name+"_print_position");        var filename=groupItem.name+ ".jpg"     capture=true;        if(selected_rbutton(radio_group2)=='measures'){           for (var ii = 0; ii< layer_meas.groupItems.length; ii++) {                    if(layer_meas.groupItems[ii].name==groupItemTemp.name+"_print_position"){                  filename=groupItem.name+ "_print_position.jpg"                  var measItem=layer_meas.groupItems[ii];                  var measItemTemp = measItem.duplicate(layerTemp, ElementPlacement.PLACEATBEGINNING);                  capture=true;                  break;                }             else{capture=false;}                                 }            }    app.executeMenuCommand("selectall");        // Para que esta llamada funcione, es necesario crear una acción en Illustrator llamada Flatten, dentro de la carpeta Flatten Transparency.    // Esta accion seleccionará Objeto -> Acoplar Transparencia (previamente se debe haber seleccionado todos los objetos mediante Seleccionar->Todo)    app.doScript('Flatten', 'Flatten Transparency', false);        var groupItemTemp= docTemp.layers[0].groupItems[0];    var groupItemBounds = groupItemTemp.visibleBounds;        var groupItemLeft = groupItemBounds[0];    var groupItemTop = groupItemBounds[1];    var groupItemWidth = groupItemBounds[2] - groupItemBounds[0];    var groupItemHeight = groupItemBounds[1] - groupItemBounds[3];    if(capture==true){        captureImage(filename, docTemp, groupItemTemp.visibleBounds,folder);    }      $.writeln("left: " + groupItemLeft + ", top: " + groupItemTop + ", width: " + groupItemWidth + ", height: " + groupItemHeight);       docTemp.close(SaveOptions.DONOTSAVECHANGES);} 